from aiogram import Router, F
from aiogram.filters import CommandStart, Command
from aiogram.types import Message, CallbackQuery
from aiogram.utils.markdown import hbold, hitalic

from src.keyboards import inline as kb

router = Router()

# –û–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å HTML-—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º
WELCOME_MESSAGE = (
    f"{hbold('–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –ü–æ–∑–¥—Ä–∞–≤–ª—è–π–∑–µ—Ä!')} ü§ñ‚ú®\n\n"
    "–Ø —Ç–≤–æ–π –ª–∏—á–Ω—ã–π –ò–ò-–ø–æ–º–æ—â–Ω–∏–∫ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è "
    f"{hitalic('–∏–¥–µ–∞–ª—å–Ω—ã—Ö')} –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–π –Ω–∞ –ª—é–±–æ–π —Å–ª—É—á–∞–π.\n\n"
    "–ù–∞–¥–æ–µ–ª–∏ –±–∞–Ω–∞–ª—å–Ω—ã–µ —Ñ—Ä–∞–∑—ã? –Ø –ø–æ–º–æ–≥—É –ø—Ä–∏–¥—É–º–∞—Ç—å —Ç–µ–ø–ª—ã–µ, –¥—É—à–µ–≤–Ω—ã–µ –∏–ª–∏ —à—É—Ç–ª–∏–≤—ã–µ —Å–ª–æ–≤–∞, "
    "–∫–æ—Ç–æ—Ä—ã–µ —Ç–æ—á–Ω–æ –∑–∞–ø–æ–º–Ω—è—Ç—Å—è!\n\n"
    f"üëá –ù–∞–∂–º–∏ {hbold('üéâ –°–æ–∑–¥–∞—Ç—å –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–µ')}, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –º–∞–≥–∏—é!"
)

# –û–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Å HTML-—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º
HOW_IT_WORKS_MESSAGE = (
    f"{hbold('–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç? –í—Å—ë –ø—Ä–æ—Å—Ç–æ!')}\n\n"
    f"1Ô∏è‚É£ {hbold('–û—Ç–≤–µ—Ç—å –Ω–∞ –ø–∞—Ä—É –≤–æ–ø—Ä–æ—Å–æ–≤:')} –ö–æ–≥–æ –ø–æ–∑–¥—Ä–∞–≤–ª—è–µ–º? –ö–∞–∫–æ–π –ø–æ–≤–æ–¥? –ö–∞–∫–æ–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ?\n\n"
    f"2Ô∏è‚É£ {hbold('–ü–æ–ª—É—á–∏ –≤–∞—Ä–∏–∞–Ω—Ç—ã:')} –Ø –ø—Ä–µ–¥–ª–æ–∂—É –Ω–µ—Å–∫–æ–ª—å–∫–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤, —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –Ω–µ–π—Ä–æ—Å–µ—Ç—å—é.\n\n"
    f"3Ô∏è‚É£ {hbold('–í—ã–±–µ—Ä–∏ –ª—É—á—à–∏–π:')} –ü—Ä–æ—Å—Ç–æ —Å–∫–æ–ø–∏—Ä—É–π –ø–æ–Ω—Ä–∞–≤–∏–≤—à–µ–µ—Å—è –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–¥–Ω–∏–º –∫–∞—Å–∞–Ω–∏–µ–º.\n\n"
    f"{hitalic('–ò–¥–µ–∞–ª—å–Ω–æ–µ –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–æ!')}\n\n"
    "‚Äî‚Äî‚Äî\n"
    "–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫ –∏–ª–∏ –µ—Å—Ç—å –∏–¥–µ–∏, –∫–∞–∫ —Å–¥–µ–ª–∞—Ç—å –º–µ–Ω—è –ª—É—á—à–µ, "
    f"–Ω–∞–ø–∏—à–∏ –º–æ–µ–º—É —Å–æ–∑–¥–∞—Ç–µ–ª—é: {hbold('@sidewinder_x')}" # TODO: –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç–∞–∫—Ç
)


@router.message(CommandStart())
async def cmd_start(message: Message):
    # –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ bot.py —É –≤–∞—Å —É–∫–∞–∑–∞–Ω parse_mode="HTML"
    await message.answer(WELCOME_MESSAGE, reply_markup=kb.get_start_keyboard())


@router.message(Command("help"))
async def cmd_help(message: Message):
    await message.answer(HOW_IT_WORKS_MESSAGE, disable_web_page_preview=True)


@router.callback_query(F.data == "how_it_works")
async def cb_how_it_works(callback: CallbackQuery):
    await callback.message.edit_text(
        HOW_IT_WORKS_MESSAGE,
        reply_markup=kb.get_start_keyboard(),
        disable_web_page_preview=True
    )
    await callback.answer()

# –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /new –ª—É—á—à–µ –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ –≤ greetings.py,
# —á—Ç–æ–±—ã –≤—Å—è –ª–æ–≥–∏–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–π –±—ã–ª–∞ –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ.
# –Ø –ø–æ–∫–∞ —É–±—Ä–∞–ª –µ–≥–æ –æ—Ç—Å—é–¥–∞, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –æ—à–∏–±–æ–∫.
